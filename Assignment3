Question 1 : 1) Read a csv file from gcp cloud storage and view the contents using python.
==============
-Create a bucket in storage.
-In google SDK, 
a. gcloud beta auth application-default login
b. gcloud beta interactive(To go to interactive shell)
Or activate google cloudshell and give ipython
This code can be used to import csv
from googleapiclient import discovery
from oauth2client.client import GoogleCredentials

credentials = GoogleCredentials.get_application_default()
service = discovery.build('storage', 'v1', credentials=credentials)

filename = 'C:\\MyFiles\\sample.csv'
bucket = 'my_bucket'

body = {'name': 'dest_file_name.csv'}
req = service.objects().insert(bucket=bucket, body=body, media_body=filename)
resp = req.execute()

Or

In bucket page, use UI to import CSV.
URL of my data: https://storage.cloud.google.com/dph_assignment_3/movie_data.csv

Reading CSV using Python
------------------------
-Create a service account for the bucket and download the JSON.


import sys
import csv
import datetime
import pandas as pd
import gcsfs

from google.cloud import storage

storage_client = storage.Client()
bucket = storage_client.get_bucket('dph_assignment_3')
blob = bucket.blob('movie_data.csv')
bt = blob.download_as_string()

from io import BytesIO
s = BytesIO(bt)
df=pd.read_csv(s)
print(df)
